{% extends "base.html" %}
{% load static %}
{% block title %}Registrar Objeto{% endblock  %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/pages/registro_objeto.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/slider.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/button.css' %}">
{% endblock %}

{% block class-header %}objR-header{% endblock  %}

{% block nav-left %}
    <a href="{% url 'home_admin' %}" class="back-arrow">&larr;</a>
{% endblock  %}

{% block class-main %}obj-register{% endblock  %}
{% block content-main %}
    <div class="register-object-container">
        <!-- Encabezado del contenedor -->
        <div class="header-container">
            <h2>Registro de Objeto Perdido</h2>
        </div>
        <form id="reg-obj-form" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="body-container">
                <div class="photo-container" id="photo-container">
                    <span id="no-img-msj">Arrastra y suelta una foto aquí o haz clic para seleccionar</span>
                    <input type="file" name="imagenes_upload" id="photo-input" accept="image/*" multiple>

                    <div class="slider-wrapper ">
                        <div class="carruseles">
                            {% for img in imagenes %}
                                <img src="{{ img.ruta_imagen.url }}" alt="Imagen del objeto" class="img-prev">
                            {% endfor %}
                        </div>
                        <div class="btn-left"><i class="bi bi-caret-left-fill"></i></div>
                        <div class="btn-right"><i class="bi bi-caret-right-fill"></i></div>
                    </div>
                </div>
                <div class="form-container">
                    {% if objeto %}
                        <input type="hidden" id="id_objeto" name="id_objeto" value="{{ objeto.id_objeto }}">
                    {% endif %}
                    <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Nombre" value="{{ objeto.nombre|default:'' }}"required>
                    </div>
                    <div class="mb-3">
                        <label for="encontrado_por" class="form-label">Encontrado por</label>
                        <input type="text" class="form-control" id="encontrado_por" name="encontrado_por" placeholder="Encontrado por" value="{{ objeto.encontrado_por|default:'' }}"required>
                    </div>
                    <div class="mb-3">
                        <label for="descripcion_general" class="form-label">Descripción General</label>
                        <textarea class="form-control" id="descripcion_general" name="descripcion_general" placeholder="Descripción General (máximo 100 carcateres)" rows="3" maxlength="100" required>{{ objeto.descripcion_general|default:'' }}</textarea>
                    </div>
                    <div class="mb-3">
                        <label for="descripcion_especifica" class="form-label">Descripción Especifica</label>
                        <textarea class="form-control" id="descripcion_especifica" name="descripcion_especifica" placeholder="Descripción Especifica (máximo 300 carcateres)" rows="3" maxlength="300" required>{{ objeto.descripcion_especifica|default:'' }}</textarea>
                    </div>
                    <div class="mb-3">
                        <label for="fecha" class="form-label">Fecha</label>
                        <input type="date" class="form-control" id="fecha" name="fecha" value="{{ objeto.fecha_perdida|date:'Y-m-d' }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="hora" class="form-label">Hora</label>
                        <input type="time" class="form-control" id="hora" name="hora" min="7:00" max="20:00" step="900" value="{{ objeto.hora|time:'H:i' }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="lugar" class="form-label">Lugar</label>
                        <select class="form-control" id="lugar" name="lugar" required>
                            <option value="">Seleccione un lugar</option>
                            <option value="Sala de Cómputo 1" {% if objeto.lugar_perdida == 'Sala de Cómputo 1' %}selected{% endif %}>Sala de Cómputo 1</option>
                            <option value="Salón 9" {% if objeto.lugar_perdida == 'Salón 9' %}selected{% endif %}>Salón 9</option>
                            <option value="Sala de usos múltiples" {% if objeto.lugar_perdida == 'Sala de usos múltiples' %}selected{% endif %}>Sala de usos múltiples</option>
                        </select>
                    </div>
                    <!-- Contenedor para centrar el botón -->
                    <div class="button-container">
                        <button type="submit" class="primary-btn">Registrar</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
{% endblock  %}
{% block extra_js %}
    {% if objeto and objeto.imagenes.all %}
        <script>
            const imagenesExistentes = [
                {% for img in objeto.imagenes.all %}
                    "{{ img.ruta_imagen.url }}"{% if not forloop.last %}, {% endif %}
                {% endfor %}
            ];
        </script>
    {% else %}
        <script>const imagenesExistentes = [];</script>
    {% endif %}

    <script type="module" src="/static/js/pages/registro_objeto.js"></script>
    <script src="/static/js/utils/date.js"></script>
{% endblock %}